# **基金TA系统业务运作指引与接口规范书 (V1.0)**

## **1\. 概述**

本指引旨在规范销售机构（代理人）及基金管理人与TA系统之间的数据交互流程与业务规则。本系统实行**看穿式账户管理**，对投资人账户及份额进行穿透式登记。

系统运行采用双批次模式。参与机构需严格遵循本指引定义的时间节点和文件规范进行报送。

## **2\. 每日运作流程 (Daily Operation Cycle)**

系统每日处理流程分为两个严格隔离的阶段，参与人需注意各阶段的交互重点：

### **第一阶段：申报与受理 (Apply Phase)**

**目标**：完成账户开户/销户申报，受理交易申请，更新当日净值。

1. **管理人动作**：  
   * 需在交易处理前发送**当日净值行情**。  
   * *注意：若净值未到达，所有交易申请将处于“挂起”状态无法处理。*  
2. **销售机构动作**：  
   * 发送**账户申请**文件（开户/销户）。  
   * 发送**交易申请**文件（申购/赎回）。  
   * *注意：账户类业务优先级高于交易类业务。当日新开户的账号，支持当日进行交易申报。*  
3. **TA系统动作**：  
   * 对申报数据进行合规性校验（见第3节）。  
   * 向销售机构反馈《账户确认文件》（告知开户/销户结果）。  
   * 将校验通过的交易申请汇总，生成《交易申请汇总表》发送给管理人。


### **第二阶段：确认与回报 (Confirm Phase)**

**目标**：接收确认结果，完成份额过账，下发最终回报。

1. **管理人动作**：  
   * 对TA发送的《交易申请汇总表》进行逻辑确认，并回传《交易确认回执》。  
   * *注意：必须包含确认份额与确认净值。*  
2. **TA系统动作**：  
   * 根据回执更新投资人份额（过账）。  
   * 生成《交易确认回报文件》发送给销售机构，作为最终结算依据。

## **3\. 业务校验规则 (Business Rules)**

TA系统将对所有申报数据执行严格的**看穿式校验**。未通过校验的指令将被直接拒绝（TA Rejected），不会报送给管理人。

### **3.1 账户类业务**

| 业务类型 | 规则代码 | 业务规则描述 | 失败反馈原因 |
| :---- | :---- | :---- | :---- |
| **开户** | 001 | 1\. 同一证件号码（ID No）在系统中必须唯一。 2\. 证件号已存在时，视为重复开户，予以拒绝。 | ID\_EXISTS |
| **销户** | 002 | 1\. 申请销户的证件号码必须在系统中存在且状态正常。 2\. 账户不存在时无法销户。 | ACCOUNT\_NOT\_FOUND |

### **3.2 交易类业务**

所有交易均需校验：**账户存在性**、**账户状态**。

| 交易类型 | 业务规则描述 | 校验逻辑 | 失败反馈原因 |
| :---- | :---- | :---- | :---- |
| **申购** (Purchase) | 投资人买入基金。 | 1\. **账户校验**：账户必须存在且状态为 NORMAL。 2\. **金额校验**：申请金额必须 \> 0。 3\. **份额计算**：实际份额在确认阶段计算。 | ACCOUNT\_NOT\_FOUND ACCOUNT\_STATUS\_ABNORMAL |
| **赎回** (Redeem) | 投资人卖出份额。 | 1\. **账户校验**：同上。 2\. **份额强校验**：TA系统将检查投资人在该基金下的**可用份额**。 3\. **拒单规则**：若 申请赎回份额 \> 可用持有份额，TA直接拒单。 | INSUFFICIENT\_SHARES (份额不足) |

## **4\. 接口文件规范 (Interface Specifications)**

所有交互文件均为 **CSV 格式**，编码 **UTF-8**，首行为字段名称。 文件名中的日期格式均为 yyyyMMdd。

### **4.1 输入：销售机构报送 (Distributor \-\> TA)**

#### **(1) 账户申请接口**

* **文件名**: {DistID}\_ACC\_{Date}.csv  
* **用途**: 每日开户/销户名单。

| 字段名 | 说明 | 必填 | 约束与示例 |
| :---- | :---- | :---- | :---- |
| request\_no | 申请单号 | Y | 销售商侧唯一流水，示例 REQ001 |
| biz\_code | 业务代码 | Y | 001:开户, 002:销户 |
| investor\_name | 投资人姓名 | Y | 示例 张三 |
| id\_no | 证件号码 | Y | **唯一索引键**，示例 11010119900101xxxx |

#### **(2) 交易申请接口**

* **文件名**: {DistID}\_TRADE\_{FundCode}\_{Date}.csv  
* **用途**: 投资人的交易指令。

| 字段名 | 说明 | 必填 | 约束与示例 |
| :---- | :---- | :---- | :---- |
| trans\_id | 交易流水号 | Y | 全局唯一，示例 TX\_20231027\_01 |
| fund\_code | 基金代码 | Y | 必须与文件名一致，示例 FUND01 |
| type | 交易类型 | Y | PURCHASE(申购) 或 REDEEM(赎回) |
| amount\_or\_shares | 数值 | Y | 申购填金额，赎回填份额。示例 1000.00 |
| account\_id | TA账号 | Y | **看穿式核心**，必须填写具体的TA账号，示例 TA10001 |

### **4.2 输入：管理人报送 (Manager \-\> TA)**

#### **(1) 净值行情接口**

* **文件名**: NAV\_{FundCode}\_{Date}.csv  
* **重要性**: 必须在交易处理前送达。

| 字段名 | 说明 | 必填 | 约束与示例 |
| :---- | :---- | :---- | :---- |
| fund\_code | 基金代码 | Y | 示例 FUND01 |
| nav | 单位净值 | Y | 示例 1.0520 |
| date | 日期 | Y | 格式 yyyyMMdd |

#### **(2) 交易确认回执接口**

* **文件名**: CONFIRM\_{Date}.csv  
* **重要性**: 必须在TA发出申请汇总后，于第二阶段报送。

| 字段名 | 说明 | 必填 | 约束与示例 |
| :---- | :---- | :---- | :---- |
| trans\_id | 交易流水号 | Y | 对应原申请流水号 |
| status | 确认状态 | Y | 1:成功, 0:失败 |
| confirmed\_shares | 确认份额 | Y | 即使失败也需回填0 |
| confirmed\_nav | 确认净值 | Y | 计算依据 |

### **4.3 输出：TA反馈数据 (TA \-\> Participants)**

#### **(1) 账户确认回报 (发往销售商)**

* **文件名**: TO\_DIST\_ACC\_CONFIRM\_{Date}.csv  
* **内容**: 开户是否成功，生成的TA账号是多少。

| 关键字段 | 说明 |
| :---- | :---- |
| request\_no | 原申请单号 |
| ta\_account\_id | **TA账号** (开户成功时生成，用于后续交易) |
| status | 1成功, 0失败 |
| message | 失败原因 (如 ID\_EXISTS) |

#### **(2) 交易确认回报 (发往销售商)**

* **文件名**: TO\_DIST\_CONFIRM\_{Date}.csv  
* **内容**: 交易最终状态（含TA拒单及管理人确认结果）。

| 关键字段 | 说明 | 示例 |
| :---- | :---- | :---- |
| trans\_id | 原交易流水 | TX\_001 |
| status | 最终状态 | CONFIRMED(成功), TA\_REJECTED(TA拒单), REJECTED(管理人拒绝) |
| confirmed\_shares | 最终确认份额 | 120.50 |
| message | 原因说明 | INSUFFICIENT\_SHARES |